<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Ahorcado Moderno Responsivo</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* Reset y variables CSS */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', system-ui, sans-serif;
            -webkit-tap-highlight-color: transparent;
        }
        
        :root {
            --primary: #4361ee;
            --primary-dark: #3a56d4;
            --secondary: #7209b7;
            --accent: #f72585;
            --success: #4cc9f0;
            --danger: #f72585;
            --light: #f8f9fa;
            --dark: #212529;
            --gray: #6c757d;
            --shadow: 0 10px 20px rgba(0, 0, 0, 0.1);
            --transition: all 0.3s ease;
            --border-radius: 20px;
        }
        
        /* Estilos base del body */
        body {
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            color: var(--light);
            min-height: 100vh;
            min-height: -webkit-fill-available;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 15px;
            overflow-x: hidden;
            position: relative;
            width: 100%;
            max-width: 100vw;
        }
        
        html {
            height: -webkit-fill-available;
            overflow-x: hidden;
        }
        
        /* Contenedor principal con relación de aspecto fija en móviles */
        .container {
            max-width: 1200px;
            width: 100%;
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 25px;
            max-height: 90vh;
            min-height: 600px;
        }
        
        /* Responsividad completa */
        @media (max-width: 1100px) {
            .container {
                grid-template-columns: 1fr;
                max-height: none;
                min-height: auto;
                gap: 20px;
            }
            
            .game-card {
                max-height: none;
                overflow-y: visible;
            }
        }
        
        @media (max-width: 768px) {
            body {
                padding: 10px;
                align-items: flex-start;
                min-height: 100vh;
                min-height: -webkit-fill-available;
            }
            
            .container {
                gap: 15px;
                max-height: none;
                min-height: auto;
            }
            
            .game-card {
                padding: 20px 15px;
                border-radius: 15px;
            }
            
            h1 {
                font-size: 2rem;
            }
        }
        
        @media (max-width: 480px) {
            body {
                padding: 8px;
            }
            
            .game-card {
                padding: 15px 10px;
                border-radius: 12px;
            }
            
            h1 {
                font-size: 1.8rem;
            }
        }
        
        /* Tarjetas del juego */
        .game-card {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(10px);
            border-radius: var(--border-radius);
            padding: 25px;
            box-shadow: var(--shadow);
            border: 1px solid rgba(255, 255, 255, 0.1);
            overflow-y: auto;
            scrollbar-width: thin;
            scrollbar-color: var(--primary) transparent;
            max-height: 85vh;
        }
        
        .game-card::-webkit-scrollbar {
            width: 6px;
        }
        
        .game-card::-webkit-scrollbar-track {
            background: transparent;
        }
        
        .game-card::-webkit-scrollbar-thumb {
            background-color: var(--primary);
            border-radius: 20px;
        }
        
        /* Cabecera */
        .header {
            text-align: center;
            margin-bottom: 25px;
        }
        
        h1 {
            font-size: 2.5rem;
            background: linear-gradient(to right, var(--primary), var(--secondary));
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            margin-bottom: 8px;
            line-height: 1.2;
        }
        
        .subtitle {
            color: var(--gray);
            font-size: 1rem;
        }
        
        /* Información del juego */
        .game-info {
            display: flex;
            justify-content: space-between;
            flex-wrap: wrap;
            margin-bottom: 25px;
            background: rgba(0, 0, 0, 0.2);
            padding: 12px;
            border-radius: 12px;
            gap: 10px;
        }
        
        .info-item {
            text-align: center;
            flex: 1;
            min-width: 100px;
        }
        
        .info-label {
            font-size: 0.8rem;
            color: var(--gray);
            margin-bottom: 4px;
        }
        
        .info-value {
            font-size: 1.3rem;
            font-weight: bold;
            color: var(--success);
        }
        
        @media (max-width: 600px) {
            .info-item {
                min-width: 70px;
            }
            
            .info-value {
                font-size: 1.1rem;
            }
        }
        
        /* Contenedor de palabras */
        .word-container {
            text-align: center;
            margin: 30px 0;
            min-height: 70px;
            display: flex;
            justify-content: center;
            align-items: center;
            flex-wrap: wrap;
            gap: 5px;
        }
        
        .letter {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            font-size: 2rem;
            font-weight: bold;
            margin: 0 5px;
            width: 40px;
            height: 50px;
            text-transform: uppercase;
            border-bottom: 4px solid var(--primary);
            transition: var(--transition);
        }
        
        @media (max-width: 768px) {
            .letter {
                font-size: 1.8rem;
                width: 35px;
                height: 45px;
                margin: 0 3px;
            }
        }
        
        @media (max-width: 480px) {
            .letter {
                font-size: 1.6rem;
                width: 30px;
                height: 40px;
                margin: 0 2px;
            }
        }
        
        .revealed {
            color: var(--success);
            transform: translateY(-5px);
        }
        
        /* Teclado responsivo */
        .keyboard {
            display: grid;
            grid-template-columns: repeat(9, 1fr);
            gap: 8px;
            margin-top: 20px;
        }
        
        @media (max-width: 992px) {
            .keyboard {
                grid-template-columns: repeat(7, 1fr);
            }
        }
        
        @media (max-width: 768px) {
            .keyboard {
                grid-template-columns: repeat(6, 1fr);
                gap: 6px;
            }
        }
        
        @media (max-width: 480px) {
            .keyboard {
                grid-template-columns: repeat(5, 1fr);
                gap: 5px;
            }
        }
        
        .key {
            background: rgba(67, 97, 238, 0.2);
            border: 2px solid var(--primary);
            border-radius: 8px;
            height: 45px;
            display: flex;
            justify-content: center;
            align-items: center;
            font-weight: bold;
            font-size: 1.1rem;
            cursor: pointer;
            transition: var(--transition);
            user-select: none;
            touch-action: manipulation;
        }
        
        @media (max-width: 768px) {
            .key {
                height: 40px;
                font-size: 1rem;
            }
        }
        
        @media (max-width: 480px) {
            .key {
                height: 35px;
                font-size: 0.9rem;
            }
        }
        
        .key:hover, .key:active {
            background: rgba(67, 97, 238, 0.4);
            transform: scale(1.05);
        }
        
        .key.used {
            background: rgba(108, 117, 125, 0.3);
            border-color: var(--gray);
            color: var(--gray);
            cursor: not-allowed;
            transform: none;
        }
        
        .key.wrong {
            background: rgba(247, 37, 133, 0.2);
            border-color: var(--danger);
            color: var(--danger);
            animation: shake 0.5s;
        }
        
        .key.correct {
            background: rgba(76, 201, 240, 0.2);
            border-color: var(--success);
            color: var(--success);
            animation: pop 0.3s;
        }
        
        /* Animaciones */
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }
        
        @keyframes pop {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }
        
        /* Contenedor del ahorcado */
        .hangman-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }
        
        .hangman-drawing {
            position: relative;
            width: 250px;
            height: 250px;
            margin: 15px 0;
        }
        
        @media (max-width: 768px) {
            .hangman-drawing {
                width: 200px;
                height: 200px;
            }
        }
        
        @media (max-width: 480px) {
            .hangman-drawing {
                width: 180px;
                height: 180px;
            }
        }
        
        /* Partes del ahorcado con tamaños relativos */
        .gallows {
            position: absolute;
            background-color: #8b4513;
            border-radius: 3px;
        }
        
        .gallows-base {
            width: 160px;
            height: 8px;
            bottom: 0;
            left: 45px;
        }
        
        .gallows-pole {
            width: 8px;
            height: 200px;
            bottom: 0;
            left: 100px;
        }
        
        .gallows-top {
            width: 80px;
            height: 8px;
            top: 30px;
            left: 100px;
        }
        
        .gallows-rope {
            width: 4px;
            height: 30px;
            background-color: #654321;
            top: 40px;
            left: 175px;
            position: absolute;
            border-radius: 3px;
        }
        
        .hangman-part {
            position: absolute;
            background-color: #f8f9fa;
            border-radius: 3px;
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        
        .head {
            width: 35px;
            height: 35px;
            border-radius: 50%;
            top: 75px;
            left: 160px;
        }
        
        .body {
            width: 8px;
            height: 70px;
            top: 110px;
            left: 175px;
        }
        
        .left-arm {
            width: 45px;
            height: 8px;
            top: 130px;
            left: 145px;
            transform: rotate(45deg);
            transform-origin: right;
        }
        
        .right-arm {
            width: 45px;
            height: 8px;
            top: 130px;
            left: 180px;
            transform: rotate(-45deg);
            transform-origin: left;
        }
        
        .left-leg {
            width: 45px;
            height: 8px;
            top: 180px;
            left: 145px;
            transform: rotate(45deg);
            transform-origin: right;
        }
        
        .right-leg {
            width: 45px;
            height: 8px;
            top: 180px;
            left: 180px;
            transform: rotate(-45deg);
            transform-origin: left;
        }
        
        .show {
            opacity: 1;
        }
        
        /* Controles responsivos */
        .controls {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 12px;
            margin-top: 25px;
        }
        
        @media (max-width: 600px) {
            .controls {
                flex-direction: column;
                gap: 10px;
            }
            
            .btn {
                width: 100%;
                justify-content: center;
            }
        }
        
        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 10px;
            font-weight: bold;
            font-size: 0.95rem;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            touch-action: manipulation;
            min-height: 44px; /* Tamaño mínimo para tocabilidad */
        }
        
        .btn-primary {
            background-color: var(--primary);
            color: white;
        }
        
        .btn-primary:hover, .btn-primary:active {
            background-color: var(--primary-dark);
            transform: scale(1.05);
        }
        
        .btn-secondary {
            background-color: rgba(255, 255, 255, 0.1);
            color: white;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .btn-secondary:hover, .btn-secondary:active {
            background-color: rgba(255, 255, 255, 0.2);
            transform: scale(1.05);
        }
        
        .btn-accent {
            background-color: var(--accent);
            color: white;
        }
        
        .btn-accent:hover, .btn-accent:active {
            background-color: #e11575;
            transform: scale(1.05);
        }
        
        /* Selector de categoría */
        .category-selector {
            margin-top: 15px;
            text-align: center;
        }
        
        .category-buttons {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 8px;
            margin-top: 8px;
        }
        
        .category-btn {
            padding: 6px 12px;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            color: var(--light);
            cursor: pointer;
            transition: var(--transition);
            font-size: 0.9rem;
            touch-action: manipulation;
        }
        
        .category-btn.active {
            background: var(--primary);
            border-color: var(--primary);
        }
        
        .category-btn:hover:not(.active) {
            background: rgba(255, 255, 255, 0.1);
        }
        
        /* Selector de dificultad */
        .difficulty-selector {
            margin-top: 15px;
            text-align: center;
        }
        
        .difficulty-buttons {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 8px;
            margin-top: 8px;
        }
        
        .difficulty-btn {
            padding: 5px 10px;
            border-radius: 12px;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            color: var(--light);
            cursor: pointer;
            transition: var(--transition);
            font-size: 0.9rem;
            touch-action: manipulation;
        }
        
        .difficulty-btn.active {
            background: var(--primary);
            border-color: var(--primary);
        }
        
        /* Caja de pistas */
        .hint-box {
            background: rgba(114, 9, 183, 0.2);
            border: 1px solid var(--secondary);
            border-radius: 10px;
            padding: 12px;
            margin-top: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .hint-text {
            font-size: 0.95rem;
            flex: 1;
        }
        
        .hint-btn {
            background: transparent;
            border: 1px solid var(--secondary);
            color: var(--secondary);
            border-radius: 50%;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: var(--transition);
            flex-shrink: 0;
            touch-action: manipulation;
        }
        
        /* Botón de sonido */
        .sound-toggle {
            position: fixed;
            top: 15px;
            right: 15px;
            background: rgba(255, 255, 255, 0.1);
            border: none;
            width: 45px;
            height: 45px;
            border-radius: 50%;
            color: white;
            cursor: pointer;
            font-size: 1.1rem;
            transition: var(--transition);
            z-index: 100;
            display: flex;
            align-items: center;
            justify-content: center;
            touch-action: manipulation;
        }
        
        @media (max-width: 480px) {
            .sound-toggle {
                top: 10px;
                right: 10px;
                width: 40px;
                height: 40px;
            }
        }
        
        .timer {
            color: var(--success);
            font-size: 1.1rem;
        }
        
        /* Mensajes modales */
        .message {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(0, 0, 0, 0.95);
            padding: 25px 40px;
            border-radius: 15px;
            text-align: center;
            z-index: 1000;
            display: none;
            border: 2px solid var(--primary);
            box-shadow: 0 0 30px rgba(67, 97, 238, 0.5);
            animation: fadeIn 0.5s;
            width: 90%;
            max-width: 400px;
            max-height: 80vh;
            overflow-y: auto;
        }
        
        .message h2 {
            font-size: 2rem;
            margin-bottom: 12px;
        }
        
        .message p {
            font-size: 1.1rem;
            margin-bottom: 15px;
        }
        
        .message-word {
            font-family: monospace;
            font-size: 1.3rem;
            color: var(--success);
            margin: 10px 0;
            letter-spacing: 3px;
            word-break: break-word;
        }
        
        .overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 999;
            display: none;
        }
        
        /* Instrucciones */
        .instructions {
            margin-top: 20px;
            padding: 15px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 12px;
        }
        
        .instructions h3 {
            margin-bottom: 10px;
            color: var(--success);
        }
        
        .instructions p {
            margin-bottom: 5px;
            font-size: 0.9rem;
        }
        
        /* Orientación landscape para móviles */
        @media (max-height: 600px) and (orientation: landscape) {
            body {
                padding: 5px;
                align-items: flex-start;
            }
            
            .container {
                grid-template-columns: 1fr 1fr;
                max-height: 95vh;
                gap: 10px;
            }
            
            .game-card {
                padding: 10px;
                max-height: 90vh;
            }
            
            h1 {
                font-size: 1.5rem;
            }
            
            .game-info {
                padding: 8px;
                margin-bottom: 15px;
            }
            
            .info-item {
                min-width: 60px;
            }
            
            .info-value {
                font-size: 1rem;
            }
            
            .letter {
                font-size: 1.5rem;
                width: 25px;
                height: 35px;
            }
            
            .keyboard {
                grid-template-columns: repeat(7, 1fr);
                gap: 4px;
            }
            
            .key {
                height: 30px;
                font-size: 0.9rem;
            }
            
            .controls {
                margin-top: 15px;
                gap: 8px;
            }
            
            .btn {
                padding: 6px 12px;
                font-size: 0.85rem;
                min-height: 36px;
            }
            
            .hangman-drawing {
                width: 150px;
                height: 150px;
            }
        }
        
        /* Prevenir zoom en inputs en iOS */
        input, select, textarea, button {
            font-size: 16px;
        }
    </style>
</head>
<body>
    <button class="sound-toggle" id="soundToggle" aria-label="Alternar sonido">
        <i class="fas fa-volume-up"></i>
    </button>
    
    <div class="container">
        <div class="game-card">
            <div class="header">
                <h1><i class="fas fa-ghost"></i> AHORCADO</h1>
                <p class="subtitle">Adivina la palabra antes de que se complete el dibujo</p>
            </div>
            
            <div class="game-info">
                <div class="info-item">
                    <div class="info-label">CATEGORÍA</div>
                    <div class="info-value" id="categoryDisplay">General</div>
                </div>
                <div class="info-item">
                    <div class="info-label">DIFICULTAD</div>
                    <div class="info-value" id="difficultyDisplay">Normal</div>
                </div>
                <div class="info-item">
                    <div class="info-label">INTENTOS</div>
                    <div class="info-value" id="attempts">6 / 6</div>
                </div>
                <div class="info-item">
                    <div class="info-label">TIEMPO</div>
                    <div class="info-value timer" id="timer">00:00</div>
                </div>
            </div>
            
            <div class="category-selector">
                <p>Selecciona una categoría:</p>
                <div class="category-buttons">
                    <div class="category-btn active" data-category="general">General</div>
                    <div class="category-btn" data-category="tecnologia">Tecnología</div>
                    <div class="category-btn" data-category="ciencia">Ciencia</div>
                    <div class="category-btn" data-category="deportes">Deportes</div>
                    <div class="category-btn" data-category="peliculas">Películas</div>
                </div>
            </div>
            
            <div class="difficulty-selector">
                <p>Dificultad:</p>
                <div class="difficulty-buttons">
                    <div class="difficulty-btn active" data-difficulty="easy">Fácil</div>
                    <div class="difficulty-btn" data-difficulty="normal">Normal</div>
                    <div class="difficulty-btn" data-difficulty="hard">Difícil</div>
                </div>
            </div>
            
            <div class="word-container" id="wordContainer">
                <!-- Las letras se generarán aquí -->
            </div>
            
            <div class="hint-box">
                <button class="hint-btn" id="hintBtn" aria-label="Obtener pista">
                    <i class="fas fa-lightbulb"></i>
                </button>
                <div class="hint-text" id="hintText">Presiona el botón para obtener una pista</div>
            </div>
            
            <div class="keyboard" id="keyboard">
                <!-- Teclado se generará aquí -->
            </div>
            
            <div class="controls">
                <button class="btn btn-primary" id="newGameBtn">
                    <i class="fas fa-play"></i> Nuevo Juego
                </button>
                <button class="btn btn-secondary" id="hintLetterBtn">
                    <i class="fas fa-question-circle"></i> Revelar Letra
                </button>
                <button class="btn btn-accent" id="solveBtn">
                    <i class="fas fa-bolt"></i> Resolver
                </button>
            </div>
        </div>
        
        <div class="game-card hangman-container">
            <h2>AHORCADO</h2>
            <div class="hangman-drawing">
                <!-- Base de la horca -->
                <div class="gallows gallows-base"></div>
                <div class="gallows gallows-pole"></div>
                <div class="gallows gallows-top"></div>
                <div class="gallows-rope"></div>
                
                <!-- Partes del ahorcado (inicialmente ocultas) -->
                <div class="hangman-part head" id="head"></div>
                <div class="hangman-part body" id="body"></div>
                <div class="hangman-part left-arm" id="leftArm"></div>
                <div class="hangman-part right-arm" id="rightArm"></div>
                <div class="hangman-part left-leg" id="leftLeg"></div>
                <div class="hangman-part right-leg" id="rightLeg"></div>
            </div>
            
            <div class="game-info">
                <div class="info-item">
                    <div class="info-label">PUNTUACIÓN</div>
                    <div class="info-value" id="score">0</div>
                </div>
                <div class="info-item">
                    <div class="info-label">RÉCORD</div>
                    <div class="info-value" id="highScore">0</div>
                </div>
                <div class="info-item">
                    <div class="info-label">PARTIDAS</div>
                    <div class="info-value" id="gamesPlayed">0</div>
                </div>
            </div>
            
            <div class="instructions">
                <h3><i class="fas fa-info-circle"></i> Instrucciones</h3>
                <p>1. Selecciona una categoría y dificultad</p>
                <p>2. Toca las letras o usa tu teclado para adivinar</p>
                <p>3. Tienes 6 intentos antes de perder</p>
                <p>4. Usa las pistas si te quedas atascado</p>
                <p>5. ¡Gana puntos por adivinar rápido y con pocos errores!</p>
            </div>
        </div>
    </div>
    
    <!-- Mensaje de victoria/derrota -->
    <div class="overlay" id="overlay"></div>
    <div class="message" id="message">
        <h2 id="messageTitle">¡Felicidades!</h2>
        <p id="messageText">Has adivinado la palabra correctamente</p>
        <div class="message-word" id="messageWord"></div>
        <p>Tiempo: <span id="messageTime">00:00</span></p>
        <p>Puntos ganados: <span id="messagePoints">0</span></p>
        <button class="btn btn-primary" id="playAgainBtn">
            <i class="fas fa-redo"></i> Jugar de nuevo
        </button>
    </div>
    
    <!-- Audio para efectos de sonido -->
    <audio id="correctSound" preload="auto">
        <source src="https://assets.mixkit.co/sfx/preview/mixkit-correct-answer-tone-2870.mp3" type="audio/mpeg">
    </audio>
    <audio id="wrongSound" preload="auto">
        <source src="https://assets.mixkit.co/sfx/preview/mixkit-wrong-answer-fail-notification-946.mp3" type="audio/mpeg">
    </audio>
    <audio id="winSound" preload="auto">
        <source src="https://assets.mixkit.co/sfx/preview/mixkit-winning-chimes-2015.mp3" type="audio/mpeg">
    </audio>
    <audio id="loseSound" preload="auto">
        <source src="https://assets.mixkit.co/sfx/preview/mixkit-sad-game-over-trombone-471.mp3" type="audio/mpeg">
    </audio>
    <audio id="clickSound" preload="auto">
        <source src="https://assets.mixkit.co/sfx/preview/mixkit-select-click-1109.mp3" type="audio/mpeg">
    </audio>

    <script>
        // Variables del juego
        let selectedWord = "";
        let guessedLetters = [];
        let wrongAttempts = 0;
        let maxAttempts = 6;
        let score = 0;
        let highScore = localStorage.getItem('hangmanHighScore') || 0;
        let gamesPlayed = localStorage.getItem('hangmanGamesPlayed') || 0;
        let category = "general";
        let difficulty = "normal";
        let timerInterval;
        let startTime;
        let elapsedTime = 0;
        let isGameActive = false;
        let soundEnabled = true;
        let hintsUsed = 0;
        let maxHints = 2;
        
        // Base de datos de palabras por categoría y dificultad
        const wordDatabase = {
            general: {
                easy: ["CASA", "PERRO", "GATO", "MESA", "SILLA", "LUNA", "SOL", "AGUA", "FUEGO", "TIERRA"],
                normal: ["ELEFANTE", "COMPUTADORA", "JARDIN", "TELEFONO", "VENTANA", "MONTANA", "OCEANO", "LIBERTAD", "FELICIDAD", "AMISTAD"],
                hard: ["EXTRAVAGANTE", "QUIMERICO", "PARALELEPIPEDO", "ONOMATOPEYA", "ESTRATOSFERA", "INCONMENSURABLE", "DESOXIRRIBONUCLEICO", "ELECTROENCEFALOGRAMA", "ANTICONSTITUCIONAL", "DESAFORESTACION"]
            },
            tecnologia: {
                easy: ["MOUSE", "WEB", "CHIP", "CODE", "APP", "WIFI", "USB", "RAM", "CPU", "LED"],
                normal: ["JAVASCRIPT", "ALGORITMO", "INTERNET", "HARDWARE", "SOFTWARE", "HACKER", "SERVIDOR", "PROGRAMA", "DATABASE", "CLOUD"],
                hard: ["INTELIGENCIA ARTIFICIAL", "CIBERSEGURIDAD", "BLOCKCHAIN", "REALIDAD VIRTUAL", "APRENDIZAJE AUTOMATICO", "PROCESAMIENTO LENGUAJE NATURAL", "INTERNET DE LAS COSAS", "COMPUTACION CUANTICA", "METAVERSO", "CROMPUESTOS DIGITALES"]
            },
            ciencia: {
                easy: ["ATOMO", "GEN", "CELULA", "LUZ", "AGUA", "AIRE", "OXIGENO", "HIERRO", "CIENCIA", "LABORATORIO"],
                normal: ["ECOSISTEMA", "EVOLUCION", "GRAVEDAD", "MOLECULA", "TELESCOPIO", "MICROSCOPIO", "ENERGIA", "FOTOSINTESIS", "BIODIVERSIDAD", "ASTEROIDE"],
                hard: ["FOTOSINTESIS", "ESPECTROMETRIA", "ELECTROMAGNETISMO", "RELATIVIDAD", "NEUROCIENCIA", "ASTROFISICA", "BIOTECNOLOGIA", "NANOTECNOLOGIA", "CRIPTOGRAFIA", "EXOBIOLOGIA"]
            },
            deportes: {
                easy: ["GOL", "RED", "PELOTA", "CANCHA", "ARCO", "RAQUETA", "META", "NATACION", "CICLISMO", "TENIS"],
                normal: ["FUTBOL", "BALONCESTO", "VOLEIBOL", "ATLETISMO", "NATACION", "ESGRIMA", "JUDO", "KARATE", "BOXEO", "SURF"],
                hard: ["PARAPENTE", "ESCALADA DEPORTIVA", "TRIATLON", "PENTATLON MODERNO", "BADMINTON", "SQUASH", "RUGBY", "HOCKEY HIERBA", "TIRO CON ARCO", "GIMNASIA RITMICA"]
            },
            peliculas: {
                easy: ["CINE", "ACTOR", "DRAMA", "COMEDIA", "ACCION", "AMOR", "GUION", "DIRECTOR", "PELICULA", "OSCAR"],
                normal: ["TITANIC", "MATRIX", "AVATAR", "JURASSIC PARK", "GLADIATOR", "INCEPTION", "INTERESTELLAR", "PARASITE", "CODA", "TENET"],
                hard: ["PSICOSIS", "APOCALYPSE NOW", "BLADE RUNNER", "PULP FICTION", "FORREST GUMP", "SCHINDLERS LIST", "LA VIDA ES BELLA", "EL PADRINO", "CIUDADANO KANE", "CASABLANCA"]
            }
        };
        
        // Pistas por categoría
        const hintsDatabase = {
            general: {
                "CASA": "Lugar donde vives",
                "PERRO": "Animal doméstico que ladra",
                "GATO": "Animal doméstico que maúlla",
                "ELEFANTE": "Animal grande con trompa",
                "COMPUTADORA": "Dispositivo electrónico para trabajar"
            },
            tecnologia: {
                "JAVASCRIPT": "Lenguaje de programación web",
                "ALGORITMO": "Conjunto de instrucciones para resolver un problema",
                "INTERNET": "Red mundial de computadoras",
                "HARDWARE": "Partes físicas de una computadora",
                "SOFTWARE": "Programas y aplicaciones"
            },
            ciencia: {
                "ECOSISTEMA": "Comunidad de seres vivos y su ambiente",
                "EVOLUCION": "Cambio en las especies a lo largo del tiempo",
                "GRAVEDAD": "Fuerza que atrae los objetos hacia la Tierra",
                "MOLECULA": "Grupo de átomos unidos",
                "TELESCOPIO": "Instrumento para observar objetos lejanos"
            },
            deportes: {
                "FUTBOL": "Deporte con balón y 11 jugadores por equipo",
                "BALONCESTO": "Deporte donde se anota en una canasta",
                "VOLEIBOL": "Deporte donde se pasa una pelota por encima de una red",
                "ATLETISMO": "Deporte que incluye carreras, saltos y lanzamientos",
                "NATACION": "Deporte en el agua"
            },
            peliculas: {
                "TITANIC": "Película sobre un barco que se hunde",
                "MATRIX": "Película de ciencia ficción con realidad virtual",
                "AVATAR": "Película de James Cameron con seres azules",
                "JURASSIC PARK": "Película sobre dinosaurios clonados",
                "GLADIATOR": "Película sobre un general romano"
            }
        };
        
        // Inicializar el juego
        function initGame() {
            // Actualizar récords
            document.getElementById('highScore').textContent = highScore;
            document.getElementById('gamesPlayed').textContent = gamesPlayed;
            document.getElementById('score').textContent = score;
            
            // Generar teclado
            generateKeyboard();
            
            // Iniciar un nuevo juego
            newGame();
            
            // Configurar eventos
            setupEventListeners();
            
            // Prevenir comportamiento por defecto de botones en móviles
            preventButtonDefaultBehavior();
            
            // Ajustar tamaños en base a la pantalla
            adjustLayoutForScreen();
            
            // Escuchar cambios de orientación
            window.addEventListener('orientationchange', adjustLayoutForScreen);
            window.addEventListener('resize', adjustLayoutForScreen);
        }
        
        // Ajustar diseño basado en el tamaño de pantalla
        function adjustLayoutForScreen() {
            const isMobile = window.innerWidth <= 768;
            const isSmallMobile = window.innerWidth <= 480;
            const isLandscape = window.innerWidth > window.innerHeight;
            
            // Ajustar contenedores según orientación
            if (isMobile && isLandscape) {
                document.body.style.alignItems = 'flex-start';
                document.body.style.padding = '5px';
                document.querySelector('.container').style.gridTemplateColumns = '1fr 1fr';
            }
            
            // Ajustar tamaño de fuente en pantallas muy pequeñas
            if (isSmallMobile) {
                document.documentElement.style.fontSize = '14px';
            } else {
                document.documentElement.style.fontSize = '16px';
            }
            
            // Forzar redibujado para prevenir bugs visuales
            setTimeout(() => {
                document.body.style.display = 'none';
                document.body.offsetHeight; // Trigger reflow
                document.body.style.display = 'flex';
            }, 10);
        }
        
        // Prevenir comportamiento por defecto en botones táctiles
        function preventButtonDefaultBehavior() {
            const buttons = document.querySelectorAll('button, .key, .category-btn, .difficulty-btn');
            buttons.forEach(button => {
                button.addEventListener('touchstart', function(e) {
                    e.preventDefault();
                    e.stopPropagation();
                    
                    // Añadir efecto visual de presión
                    this.style.transform = 'scale(0.95)';
                    
                    // Quitar el efecto después de 150ms
                    setTimeout(() => {
                        this.style.transform = '';
                    }, 150);
                }, {passive: false});
                
                button.addEventListener('touchend', function(e) {
                    e.preventDefault();
                    e.stopPropagation();
                }, {passive: false});
            });
        }
        
        // Generar el teclado en pantalla
        function generateKeyboard() {
            const keyboard = document.getElementById('keyboard');
            keyboard.innerHTML = '';
            
            const letters = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ';
            
            for (let letter of letters) {
                const key = document.createElement('div');
                key.className = 'key';
                key.textContent = letter;
                key.dataset.letter = letter;
                key.setAttribute('role', 'button');
                key.setAttribute('aria-label', `Letra ${letter}`);
                key.setAttribute('tabindex', '0');
                
                // Evento click/touch
                key.addEventListener('click', () => handleLetterClick(letter, key));
                
                // Evento táctil
                key.addEventListener('touchstart', (e) => {
                    e.preventDefault();
                    handleLetterClick(letter, key);
                }, {passive: false});
                
                // Evento teclado para accesibilidad
                key.addEventListener('keydown', (e) => {
                    if (e.key === 'Enter' || e.key === ' ') {
                        e.preventDefault();
                        handleLetterClick(letter, key);
                    }
                });
                
                keyboard.appendChild(key);
            }
        }
        
        // Manejar clic en letra
        function handleLetterClick(letter, keyElement) {
            if (isGameActive && !keyElement.classList.contains('used')) {
                guessLetter(letter);
                
                // Efecto visual de presión
                keyElement.style.transform = 'scale(0.9)';
                setTimeout(() => {
                    keyElement.style.transform = '';
                }, 150);
            }
        }
        
        // Configurar eventos
        function setupEventListeners() {
            // Teclado físico
            document.addEventListener('keydown', (e) => {
                if (!isGameActive) return;
                
                const key = e.key.toUpperCase();
                if (/^[A-Z]$/.test(key) && !isLetterUsed(key)) {
                    guessLetter(key);
                }
                
                // Permitir usar Enter para nuevo juego cuando el juego no está activo
                if (e.key === 'Enter' && !isGameActive) {
                    newGame();
                }
            });
            
            // Botón nuevo juego
            const newGameBtn = document.getElementById('newGameBtn');
            newGameBtn.addEventListener('click', newGame);
            newGameBtn.addEventListener('touchstart', (e) => e.preventDefault(), {passive: false});
            
            // Botón jugar de nuevo en mensaje
            const playAgainBtn = document.getElementById('playAgainBtn');
            playAgainBtn.addEventListener('click', () => {
                hideMessage();
                newGame();
            });
            playAgainBtn.addEventListener('touchstart', (e) => e.preventDefault(), {passive: false});
            
            // Botón pista
            const hintBtn = document.getElementById('hintBtn');
            hintBtn.addEventListener('click', giveHint);
            hintBtn.addEventListener('touchstart', (e) => e.preventDefault(), {passive: false});
            
            // Botón revelar letra
            const hintLetterBtn = document.getElementById('hintLetterBtn');
            hintLetterBtn.addEventListener('click', revealRandomLetter);
            hintLetterBtn.addEventListener('touchstart', (e) => e.preventDefault(), {passive: false});
            
            // Botón resolver
            const solveBtn = document.getElementById('solveBtn');
            solveBtn.addEventListener('click', solveWord);
            solveBtn.addEventListener('touchstart', (e) => e.preventDefault(), {passive: false});
            
            // Botones de categoría
            document.querySelectorAll('.category-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    document.querySelectorAll('.category-btn').forEach(b => b.classList.remove('active'));
                    this.classList.add('active');
                    category = this.dataset.category;
                    document.getElementById('categoryDisplay').textContent = 
                        this.textContent.charAt(0).toUpperCase() + this.textContent.slice(1);
                    
                    if (isGameActive) {
                        newGame();
                    }
                });
                
                btn.addEventListener('touchstart', (e) => e.preventDefault(), {passive: false});
            });
            
            // Botones de dificultad
            document.querySelectorAll('.difficulty-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    document.querySelectorAll('.difficulty-btn').forEach(b => b.classList.remove('active'));
                    this.classList.add('active');
                    difficulty = this.dataset.difficulty;
                    document.getElementById('difficultyDisplay').textContent = 
                        this.textContent.charAt(0).toUpperCase() + this.textContent.slice(1);
                    
                    if (isGameActive) {
                        newGame();
                    }
                });
                
                btn.addEventListener('touchstart', (e) => e.preventDefault(), {passive: false});
            });
            
            // Botón de sonido
            const soundToggle = document.getElementById('soundToggle');
            soundToggle.addEventListener('click', toggleSound);
            soundToggle.addEventListener('touchstart', (e) => e.preventDefault(), {passive: false});
            
            // Prevenir zoom en iOS al hacer doble tap
            document.addEventListener('dblclick', (e) => {
                if (e.target.classList.contains('key') || 
                    e.target.classList.contains('btn') ||
                    e.target.classList.contains('category-btn') ||
                    e.target.classList.contains('difficulty-btn')) {
                    e.preventDefault();
                }
            });
        }
        
        // Iniciar un nuevo juego
        function newGame() {
            // Seleccionar palabra aleatoria según categoría y dificultad
            const wordList = wordDatabase[category][difficulty];
            selectedWord = wordList[Math.floor(Math.random() * wordList.length)];
            
            // Reiniciar variables
            guessedLetters = [];
            wrongAttempts = 0;
            hintsUsed = 0;
            isGameActive = true;
            
            // Actualizar intentos
            updateAttemptsDisplay();
            
            // Reiniciar dibujo del ahorcado
            resetHangmanDrawing();
            
            // Generar display de la palabra
            generateWordDisplay();
            
            // Reiniciar teclado
            resetKeyboard();
            
            // Reiniciar pista
            document.getElementById('hintText').textContent = `Pistas disponibles: ${maxHints}`;
            
            // Iniciar temporizador
            startTimer();
            
            // Actualizar estadísticas
            gamesPlayed++;
            localStorage.setItem('hangmanGamesPlayed', gamesPlayed);
            document.getElementById('gamesPlayed').textContent = gamesPlayed;
            
            // Enfocar el primer elemento interactivo para accesibilidad
            setTimeout(() => {
                document.querySelector('.key').focus();
            }, 100);
        }
        
        // Generar display de la palabra
        function generateWordDisplay() {
            const wordContainer = document.getElementById('wordContainer');
            wordContainer.innerHTML = '';
            
            for (let i = 0; i < selectedWord.length; i++) {
                const letter = selectedWord[i];
                const letterElement = document.createElement('div');
                
                if (letter === ' ') {
                    letterElement.className = 'letter space';
                    letterElement.innerHTML = '&nbsp;';
                    letterElement.style.borderBottom = 'none';
                    letterElement.style.margin = '0 10px';
                } else {
                    letterElement.className = 'letter';
                    letterElement.textContent = guessedLetters.includes(letter) ? letter : '';
                    letterElement.dataset.letter = letter;
                }
                
                wordContainer.appendChild(letterElement);
            }
        }
        
        // Adivinar una letra
        function guessLetter(letter) {
            if (!isGameActive) return;
            
            playSound('click');
            
            // Marcar letra como usada
            markLetterAsUsed(letter);
            
            if (selectedWord.includes(letter)) {
                // Letra correcta
                playSound('correct');
                
                // Añadir a letras adivinadas
                if (!guessedLetters.includes(letter)) {
                    guessedLetters.push(letter);
                }
                
                // Actualizar display
                updateWordDisplay();
                
                // Verificar si ganó
                if (checkWin()) {
                    endGame(true);
                }
            } else {
                // Letra incorrecta
                playSound('wrong');
                
                wrongAttempts++;
                updateAttemptsDisplay();
                updateHangmanDrawing();
                
                // Verificar si perdió
                if (wrongAttempts >= maxAttempts) {
                    endGame(false);
                }
            }
        }
        
        // Marcar letra como usada en el teclado
        function markLetterAsUsed(letter) {
            const keyElement = document.querySelector(`.key[data-letter="${letter}"]`);
            if (keyElement && !keyElement.classList.contains('used')) {
                keyElement.classList.add('used');
                
                if (selectedWord.includes(letter)) {
                    keyElement.classList.add('correct');
                } else {
                    keyElement.classList.add('wrong');
                }
            }
        }
        
        // Verificar si una letra ya fue usada
        function isLetterUsed(letter) {
            const keyElement = document.querySelector(`.key[data-letter="${letter}"]`);
            return keyElement && keyElement.classList.contains('used');
        }
        
        // Actualizar display de la palabra
        function updateWordDisplay() {
            const letterElements = document.querySelectorAll('.letter:not(.space)');
            
            letterElements.forEach(element => {
                const letter = element.dataset.letter;
                if (guessedLetters.includes(letter)) {
                    element.textContent = letter;
                    element.classList.add('revealed');
                }
            });
        }
        
        // Actualizar display de intentos
        function updateAttemptsDisplay() {
            document.getElementById('attempts').textContent = `${maxAttempts - wrongAttempts} / ${maxAttempts}`;
        }
        
        // Actualizar dibujo del ahorcado
        function updateHangmanDrawing() {
            const parts = ['head', 'body', 'leftArm', 'rightArm', 'leftLeg', 'rightLeg'];
            
            if (wrongAttempts > 0 && wrongAttempts <= parts.length) {
                const part = document.getElementById(parts[wrongAttempts - 1]);
                part.classList.add('show');
            }
        }
        
        // Reiniciar dibujo del ahorcado
        function resetHangmanDrawing() {
            const parts = document.querySelectorAll('.hangman-part');
            parts.forEach(part => {
                part.classList.remove('show');
            });
        }
        
        // Reiniciar teclado
        function resetKeyboard() {
            const keys = document.querySelectorAll('.key');
            keys.forEach(key => {
                key.classList.remove('used', 'correct', 'wrong');
                key.style.transform = '';
            });
        }
        
        // Verificar si ganó
        function checkWin() {
            for (let i = 0; i < selectedWord.length; i++) {
                const letter = selectedWord[i];
                if (letter !== ' ' && !guessedLetters.includes(letter)) {
                    return false;
                }
            }
            return true;
        }
        
        // Dar una pista
        function giveHint() {
            if (!isGameActive || hintsUsed >= maxHints) return;
            
            // Verificar si hay pista para esta palabra
            const categoryHints = hintsDatabase[category];
            if (categoryHints && categoryHints[selectedWord]) {
                document.getElementById('hintText').textContent = categoryHints[selectedWord];
                hintsUsed++;
            } else {
                // Pista genérica si no hay específica
                document.getElementById('hintText').textContent = `La palabra tiene ${selectedWord.length} letras y pertenece a la categoría "${category}"`;
                hintsUsed++;
            }
            
            playSound('click');
        }
        
        // Revelar una letra aleatoria
        function revealRandomLetter() {
            if (!isGameActive) return;
            
            // Encontrar letras no adivinadas
            const unrevealedLetters = [];
            for (let i = 0; i < selectedWord.length; i++) {
                const letter = selectedWord[i];
                if (letter !== ' ' && !guessedLetters.includes(letter) && !unrevealedLetters.includes(letter)) {
                    unrevealedLetters.push(letter);
                }
            }
            
            if (unrevealedLetters.length > 0) {
                // Seleccionar letra aleatoria no adivinada
                const randomLetter = unrevealedLetters[Math.floor(Math.random() * unrevealedLetters.length)];
                
                // Adivinar la letra
                guessedLetters.push(randomLetter);
                updateWordDisplay();
                markLetterAsUsed(randomLetter);
                
                // Verificar si ganó
                if (checkWin()) {
                    endGame(true);
                }
                
                playSound('correct');
            }
        }
        
        // Resolver la palabra automáticamente
        function solveWord() {
            if (!isGameActive) return;
            
            // Revelar todas las letras
            for (let i = 0; i < selectedWord.length; i++) {
                const letter = selectedWord[i];
                if (letter !== ' ' && !guessedLetters.includes(letter)) {
                    guessedLetters.push(letter);
                }
            }
            
            updateWordDisplay();
            
            // Marcar todas las letras en el teclado
            const letters = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ';
            for (let letter of letters) {
                if (selectedWord.includes(letter)) {
                    const keyElement = document.querySelector(`.key[data-letter="${letter}"]`);
                    if (keyElement) {
                        keyElement.classList.add('used', 'correct');
                    }
                }
            }
            
            // Terminar el juego (con penalización)
            endGame(true, true);
            playSound('win');
        }
        
        // Iniciar temporizador
        function startTimer() {
            clearInterval(timerInterval);
            startTime = Date.now();
            elapsedTime = 0;
            
            timerInterval = setInterval(() => {
                if (isGameActive) {
                    elapsedTime = Math.floor((Date.now() - startTime) / 1000);
                    const minutes = Math.floor(elapsedTime / 60);
                    const seconds = elapsedTime % 60;
                    document.getElementById('timer').textContent = 
                        `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
                }
            }, 1000);
        }
        
        // Terminar el juego
        function endGame(isWin, solved = false) {
            isGameActive = false;
            clearInterval(timerInterval);
            
            // Calcular puntos
            let pointsEarned = 0;
            
            if (isWin) {
                // Base por ganar
                pointsEarned = 100;
                
                // Bonus por dificultad
                if (difficulty === 'normal') pointsEarned += 50;
                if (difficulty === 'hard') pointsEarned += 100;
                
                // Penalización por tiempo (menos puntos cuanto más tiempo)
                pointsEarned = Math.max(10, pointsEarned - Math.floor(elapsedTime / 5));
                
                // Penalización por errores
                pointsEarned = Math.max(10, pointsEarned - (wrongAttempts * 10));
                
                // Penalización por pistas usadas
                pointsEarned = Math.max(10, pointsEarned - (hintsUsed * 20));
                
                // Penalización por resolver automáticamente
                if (solved) {
                    pointsEarned = Math.floor(pointsEarned / 4);
                }
                
                // Actualizar puntuación
                score += pointsEarned;
                document.getElementById('score').textContent = score;
                
                // Actualizar récord si es mayor
                if (score > highScore) {
                    highScore = score;
                    localStorage.setItem('hangmanHighScore', highScore);
                    document.getElementById('highScore').textContent = highScore;
                }
                
                playSound('win');
            } else {
                playSound('lose');
            }
            
            // Mostrar mensaje
            showMessage(isWin, pointsEarned);
        }
        
        // Mostrar mensaje de victoria/derrota
        function showMessage(isWin, pointsEarned) {
            const message = document.getElementById('message');
            const overlay = document.getElementById('overlay');
            const title = document.getElementById('messageTitle');
            const text = document.getElementById('messageText');
            const word = document.getElementById('messageWord');
            const time = document.getElementById('messageTime');
            const points = document.getElementById('messagePoints');
            
            if (isWin) {
                title.textContent = '¡Felicidades!';
                text.textContent = 'Has adivinado la palabra correctamente';
                title.style.color = '#4cc9f0';
            } else {
                title.textContent = '¡Game Over!';
                text.textContent = 'Se ha completado el dibujo del ahorcado';
                title.style.color = '#f72585';
            }
            
            word.textContent = selectedWord;
            
            const minutes = Math.floor(elapsedTime / 60);
            const seconds = elapsedTime % 60;
            time.textContent = `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
            
            points.textContent = isWin ? pointsEarned : 0;
            
            message.style.display = 'block';
            overlay.style.display = 'block';
            
            // Enfocar botón de jugar de nuevo
            setTimeout(() => {
                document.getElementById('playAgainBtn').focus();
            }, 100);
        }
        
        // Ocultar mensaje
        function hideMessage() {
            document.getElementById('message').style.display = 'none';
            document.getElementById('overlay').style.display = 'none';
        }
        
        // Reproducir sonido
        function playSound(type) {
            if (!soundEnabled) return;
            
            const soundMap = {
                'correct': document.getElementById('correctSound'),
                'wrong': document.getElementById('wrongSound'),
                'win': document.getElementById('winSound'),
                'lose': document.getElementById('loseSound'),
                'click': document.getElementById('clickSound')
            };
            
            if (soundMap[type]) {
                // Reiniciar sonido si ya se estaba reproduciendo
                soundMap[type].currentTime = 0;
                
                // Reproducir con manejo de errores
                soundMap[type].play().catch(e => {
                    console.log("Error reproduciendo sonido:", e);
                    // En algunos dispositivos móviles, necesitamos interacción del usuario primero
                    if (e.name === 'NotAllowedError') {
                        // Habilitar sonido para el futuro
                        soundEnabled = true;
                        document.getElementById('soundToggle').innerHTML = '<i class="fas fa-volume-up"></i>';
                    }
                });
            }
        }
        
        // Alternar sonido
        function toggleSound() {
            soundEnabled = !soundEnabled;
            const icon = document.querySelector('#soundToggle i');
            
            if (soundEnabled) {
                icon.className = 'fas fa-volume-up';
                document.getElementById('soundToggle').style.color = 'white';
                // Probar reproducción de sonido
                playSound('click');
            } else {
                icon.className = 'fas fa-volume-mute';
                document.getElementById('soundToggle').style.color = '#f72585';
            }
        }
        
        // Inicializar cuando se carga la página
        window.addEventListener('DOMContentLoaded', initGame);
        
        // Prevenir recarga en móviles al deslizar
        document.addEventListener('touchmove', function(e) {
            if (e.target.classList.contains('game-card')) {
                e.preventDefault();
            }
        }, { passive: false });
    </script>
</body>
</html>